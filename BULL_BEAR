{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":86157,"status":"ok","timestamp":1728050379301,"user":{"displayName":"Ghaffar Elahi","userId":"03211535299359125772"},"user_tz":-300},"id":"En2VoikJcHyY","outputId":"558d4dd9-1be3-4b76-f437-6c96b1c88cc7"},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: vectorbt in /usr/local/lib/python3.10/site-packages (0.26.2)\n","Requirement already satisfied: numpy<2.0.0,>=1.16.5 in /usr/local/lib/python3.10/site-packages (from vectorbt) (1.23.5)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/site-packages (from vectorbt) (2.2.3)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.10/site-packages (from vectorbt) (1.14.1)\n","Requirement already satisfied: matplotlib in /usr/local/lib/python3.10/site-packages (from vectorbt) (3.9.2)\n","Requirement already satisfied: plotly>=4.12.0 in /usr/local/lib/python3.10/site-packages (from vectorbt) (5.24.1)\n","Requirement already satisfied: ipywidgets>=7.0.0 in /usr/local/lib/python3.10/site-packages (from vectorbt) (8.1.5)\n","Requirement already satisfied: dill in /usr/local/lib/python3.10/site-packages (from vectorbt) (0.3.9)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/site-packages (from vectorbt) (4.66.1)\n","Requirement already satisfied: dateparser in /usr/local/lib/python3.10/site-packages (from vectorbt) (1.2.0)\n","Requirement already satisfied: imageio in /usr/local/lib/python3.10/site-packages (from vectorbt) (2.35.1)\n","Requirement already satisfied: scikit-learn in /usr/local/lib/python3.10/site-packages (from vectorbt) (1.5.2)\n","Requirement already satisfied: schedule in /usr/local/lib/python3.10/site-packages (from vectorbt) (1.2.2)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/site-packages (from vectorbt) (2.31.0)\n","Requirement already satisfied: pytz in /usr/local/lib/python3.10/site-packages (from vectorbt) (2024.2)\n","Requirement already satisfied: mypy-extensions in /usr/local/lib/python3.10/site-packages (from vectorbt) (1.0.0)\n","Requirement already satisfied: numba<0.57.0,>=0.56.0 in /usr/local/lib/python3.10/site-packages (from vectorbt) (0.56.4)\n","Requirement already satisfied: comm>=0.1.3 in /usr/local/lib/python3.10/site-packages (from ipywidgets>=7.0.0->vectorbt) (0.2.2)\n","Requirement already satisfied: ipython>=6.1.0 in /usr/local/lib/python3.10/site-packages (from ipywidgets>=7.0.0->vectorbt) (8.28.0)\n","Requirement already satisfied: traitlets>=4.3.1 in /usr/local/lib/python3.10/site-packages (from ipywidgets>=7.0.0->vectorbt) (5.14.3)\n","Requirement already satisfied: widgetsnbextension~=4.0.12 in /usr/local/lib/python3.10/site-packages (from ipywidgets>=7.0.0->vectorbt) (4.0.13)\n","Requirement already satisfied: jupyterlab-widgets~=3.0.12 in /usr/local/lib/python3.10/site-packages (from ipywidgets>=7.0.0->vectorbt) (3.0.13)\n","Requirement already satisfied: llvmlite<0.40,>=0.39.0dev0 in /usr/local/lib/python3.10/site-packages (from numba<0.57.0,>=0.56.0->vectorbt) (0.39.1)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.10/site-packages (from numba<0.57.0,>=0.56.0->vectorbt) (68.2.2)\n","Requirement already satisfied: tenacity>=6.2.0 in /usr/local/lib/python3.10/site-packages (from plotly>=4.12.0->vectorbt) (9.0.0)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/site-packages (from plotly>=4.12.0->vectorbt) (23.2)\n","Requirement already satisfied: python-dateutil in /usr/local/lib/python3.10/site-packages (from dateparser->vectorbt) (2.9.0.post0)\n","Requirement already satisfied: regex!=2019.02.19,!=2021.8.27 in /usr/local/lib/python3.10/site-packages (from dateparser->vectorbt) (2024.9.11)\n","Requirement already satisfied: tzlocal in /usr/local/lib/python3.10/site-packages (from dateparser->vectorbt) (5.2)\n","Requirement already satisfied: pillow>=8.3.2 in /usr/local/lib/python3.10/site-packages (from imageio->vectorbt) (10.4.0)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/site-packages (from matplotlib->vectorbt) (1.3.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/site-packages (from matplotlib->vectorbt) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/site-packages (from matplotlib->vectorbt) (4.54.1)\n","Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.10/site-packages (from matplotlib->vectorbt) (1.4.7)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/site-packages (from matplotlib->vectorbt) (3.1.4)\n","Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.10/site-packages (from pandas->vectorbt) (2024.2)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/site-packages (from requests->vectorbt) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/site-packages (from requests->vectorbt) (3.6)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/site-packages (from requests->vectorbt) (2.1.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/site-packages (from requests->vectorbt) (2024.8.30)\n","Requirement already satisfied: joblib>=1.2.0 in /usr/local/lib/python3.10/site-packages (from scikit-learn->vectorbt) (1.4.2)\n","Requirement already satisfied: threadpoolctl>=3.1.0 in /usr/local/lib/python3.10/site-packages (from scikit-learn->vectorbt) (3.5.0)\n","Requirement already satisfied: decorator in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (5.1.1)\n","Requirement already satisfied: jedi>=0.16 in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (0.19.1)\n","Requirement already satisfied: matplotlib-inline in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (0.1.7)\n","Requirement already satisfied: prompt-toolkit<3.1.0,>=3.0.41 in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (3.0.48)\n","Requirement already satisfied: pygments>=2.4.0 in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (2.18.0)\n","Requirement already satisfied: stack-data in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (0.6.3)\n","Requirement already satisfied: exceptiongroup in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (1.2.2)\n","Requirement already satisfied: typing-extensions>=4.6 in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (4.12.2)\n","Requirement already satisfied: pexpect>4.3 in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (4.9.0)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/site-packages (from python-dateutil->dateparser->vectorbt) (1.16.0)\n","Requirement already satisfied: parso<0.9.0,>=0.8.3 in /usr/local/lib/python3.10/site-packages (from jedi>=0.16->ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (0.8.4)\n","Requirement already satisfied: ptyprocess>=0.5 in /usr/local/lib/python3.10/site-packages (from pexpect>4.3->ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (0.7.0)\n","Requirement already satisfied: wcwidth in /usr/local/lib/python3.10/site-packages (from prompt-toolkit<3.1.0,>=3.0.41->ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (0.2.13)\n","Requirement already satisfied: executing>=1.2.0 in /usr/local/lib/python3.10/site-packages (from stack-data->ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (2.1.0)\n","Requirement already satisfied: asttokens>=2.1.0 in /usr/local/lib/python3.10/site-packages (from stack-data->ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (2.4.1)\n","Requirement already satisfied: pure-eval in /usr/local/lib/python3.10/site-packages (from stack-data->ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (0.2.3)\n","Collecting condacolab\n","  Using cached condacolab-0.1.9-py3-none-any.whl.metadata (5.6 kB)\n","Using cached condacolab-0.1.9-py3-none-any.whl (7.2 kB)\n","Installing collected packages: condacolab\n","Successfully installed condacolab-0.1.9\n","‚ú®üç∞‚ú® Everything looks OK!\n","Channels:\n"," - conda-forge\n","Platform: linux-64\n","Collecting package metadata (repodata.json): - \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\b\\ \b\b| \b\b/ \b\b- \b\bdone\n","Solving environment: | \b\b/ \b\b- \b\b\\ \b\bdone\n","\n","\n","==> WARNING: A newer version of conda exists. <==\n","    current version: 23.11.0\n","    latest version: 24.9.1\n","\n","Please update conda by running\n","\n","    $ conda update -n base -c conda-forge conda\n","\n","\n","\n","# All requested packages already installed.\n","\n","Requirement already satisfied: vectorbt in /usr/local/lib/python3.10/site-packages (0.26.2)\n","Requirement already satisfied: numpy<2.0.0,>=1.16.5 in /usr/local/lib/python3.10/site-packages (from vectorbt) (1.23.5)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/site-packages (from vectorbt) (2.2.3)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.10/site-packages (from vectorbt) (1.14.1)\n","Requirement already satisfied: matplotlib in /usr/local/lib/python3.10/site-packages (from vectorbt) (3.9.2)\n","Requirement already satisfied: plotly>=4.12.0 in /usr/local/lib/python3.10/site-packages (from vectorbt) (5.24.1)\n","Requirement already satisfied: ipywidgets>=7.0.0 in /usr/local/lib/python3.10/site-packages (from vectorbt) (8.1.5)\n","Requirement already satisfied: dill in /usr/local/lib/python3.10/site-packages (from vectorbt) (0.3.9)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/site-packages (from vectorbt) (4.66.1)\n","Requirement already satisfied: dateparser in /usr/local/lib/python3.10/site-packages (from vectorbt) (1.2.0)\n","Requirement already satisfied: imageio in /usr/local/lib/python3.10/site-packages (from vectorbt) (2.35.1)\n","Requirement already satisfied: scikit-learn in /usr/local/lib/python3.10/site-packages (from vectorbt) (1.5.2)\n","Requirement already satisfied: schedule in /usr/local/lib/python3.10/site-packages (from vectorbt) (1.2.2)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/site-packages (from vectorbt) (2.31.0)\n","Requirement already satisfied: pytz in /usr/local/lib/python3.10/site-packages (from vectorbt) (2024.2)\n","Requirement already satisfied: mypy-extensions in /usr/local/lib/python3.10/site-packages (from vectorbt) (1.0.0)\n","Requirement already satisfied: numba<0.57.0,>=0.56.0 in /usr/local/lib/python3.10/site-packages (from vectorbt) (0.56.4)\n","Requirement already satisfied: comm>=0.1.3 in /usr/local/lib/python3.10/site-packages (from ipywidgets>=7.0.0->vectorbt) (0.2.2)\n","Requirement already satisfied: ipython>=6.1.0 in /usr/local/lib/python3.10/site-packages (from ipywidgets>=7.0.0->vectorbt) (8.28.0)\n","Requirement already satisfied: traitlets>=4.3.1 in /usr/local/lib/python3.10/site-packages (from ipywidgets>=7.0.0->vectorbt) (5.14.3)\n","Requirement already satisfied: widgetsnbextension~=4.0.12 in /usr/local/lib/python3.10/site-packages (from ipywidgets>=7.0.0->vectorbt) (4.0.13)\n","Requirement already satisfied: jupyterlab-widgets~=3.0.12 in /usr/local/lib/python3.10/site-packages (from ipywidgets>=7.0.0->vectorbt) (3.0.13)\n","Requirement already satisfied: llvmlite<0.40,>=0.39.0dev0 in /usr/local/lib/python3.10/site-packages (from numba<0.57.0,>=0.56.0->vectorbt) (0.39.1)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.10/site-packages (from numba<0.57.0,>=0.56.0->vectorbt) (68.2.2)\n","Requirement already satisfied: tenacity>=6.2.0 in /usr/local/lib/python3.10/site-packages (from plotly>=4.12.0->vectorbt) (9.0.0)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/site-packages (from plotly>=4.12.0->vectorbt) (23.2)\n","Requirement already satisfied: python-dateutil in /usr/local/lib/python3.10/site-packages (from dateparser->vectorbt) (2.9.0.post0)\n","Requirement already satisfied: regex!=2019.02.19,!=2021.8.27 in /usr/local/lib/python3.10/site-packages (from dateparser->vectorbt) (2024.9.11)\n","Requirement already satisfied: tzlocal in /usr/local/lib/python3.10/site-packages (from dateparser->vectorbt) (5.2)\n","Requirement already satisfied: pillow>=8.3.2 in /usr/local/lib/python3.10/site-packages (from imageio->vectorbt) (10.4.0)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/site-packages (from matplotlib->vectorbt) (1.3.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/site-packages (from matplotlib->vectorbt) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/site-packages (from matplotlib->vectorbt) (4.54.1)\n","Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.10/site-packages (from matplotlib->vectorbt) (1.4.7)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/site-packages (from matplotlib->vectorbt) (3.1.4)\n","Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.10/site-packages (from pandas->vectorbt) (2024.2)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/site-packages (from requests->vectorbt) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/site-packages (from requests->vectorbt) (3.6)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/site-packages (from requests->vectorbt) (2.1.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/site-packages (from requests->vectorbt) (2024.8.30)\n","Requirement already satisfied: joblib>=1.2.0 in /usr/local/lib/python3.10/site-packages (from scikit-learn->vectorbt) (1.4.2)\n","Requirement already satisfied: threadpoolctl>=3.1.0 in /usr/local/lib/python3.10/site-packages (from scikit-learn->vectorbt) (3.5.0)\n","Requirement already satisfied: decorator in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (5.1.1)\n","Requirement already satisfied: jedi>=0.16 in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (0.19.1)\n","Requirement already satisfied: matplotlib-inline in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (0.1.7)\n","Requirement already satisfied: prompt-toolkit<3.1.0,>=3.0.41 in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (3.0.48)\n","Requirement already satisfied: pygments>=2.4.0 in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (2.18.0)\n","Requirement already satisfied: stack-data in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (0.6.3)\n","Requirement already satisfied: exceptiongroup in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (1.2.2)\n","Requirement already satisfied: typing-extensions>=4.6 in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (4.12.2)\n","Requirement already satisfied: pexpect>4.3 in /usr/local/lib/python3.10/site-packages (from ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (4.9.0)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/site-packages (from python-dateutil->dateparser->vectorbt) (1.16.0)\n","Requirement already satisfied: parso<0.9.0,>=0.8.3 in /usr/local/lib/python3.10/site-packages (from jedi>=0.16->ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (0.8.4)\n","Requirement already satisfied: ptyprocess>=0.5 in /usr/local/lib/python3.10/site-packages (from pexpect>4.3->ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (0.7.0)\n","Requirement already satisfied: wcwidth in /usr/local/lib/python3.10/site-packages (from prompt-toolkit<3.1.0,>=3.0.41->ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (0.2.13)\n","Requirement already satisfied: executing>=1.2.0 in /usr/local/lib/python3.10/site-packages (from stack-data->ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (2.1.0)\n","Requirement already satisfied: asttokens>=2.1.0 in /usr/local/lib/python3.10/site-packages (from stack-data->ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (2.4.1)\n","Requirement already satisfied: pure-eval in /usr/local/lib/python3.10/site-packages (from stack-data->ipython>=6.1.0->ipywidgets>=7.0.0->vectorbt) (0.2.3)\n","Found existing installation: cffi 1.17.0\n","Uninstalling cffi-1.17.0:\n","  Successfully uninstalled cffi-1.17.0\n","\u001b[31mERROR: Invalid requirement: '_cffi_backend'\u001b[0m\u001b[31m\n","\u001b[0mCollecting cffi==1.17.0\n","  Using cached cffi-1.17.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (1.5 kB)\n","Requirement already satisfied: pycparser in /usr/local/lib/python3.10/site-packages (from cffi==1.17.0) (2.21)\n","Using cached cffi-1.17.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (445 kB)\n","Installing collected packages: cffi\n","Successfully installed cffi-1.17.0\n","1.17.1\n","1.17.0\n"]}],"source":["!pip install vectorbt\n","!pip install condacolab\n","import condacolab\n","condacolab.install()\n","!conda install -c conda-forge ta-lib\n","!pip install vectorbt\n","!pip uninstall -y cffi\n","!pip uninstall -y _cffi_backend\n","!pip install cffi==1.17.0\n","import cffi\n","import _cffi_backend\n","print(cffi.__version__)\n","print(_cffi_backend.__version__)"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5906,"status":"ok","timestamp":1728050385180,"user":{"displayName":"Ghaffar Elahi","userId":"03211535299359125772"},"user_tz":-300},"id":"OH6xn1r1hSi6","outputId":"dcc6c02b-6ef8-4576-ac0e-7f75356e6b47"},"outputs":[{"output_type":"stream","name":"stdout","text":["Found existing installation: cffi 1.17.0\n","Uninstalling cffi-1.17.0:\n","  Successfully uninstalled cffi-1.17.0\n","\u001b[31mERROR: Invalid requirement: '_cffi_backend'\u001b[0m\u001b[31m\n","\u001b[0mCollecting cffi==1.17.0\n","  Using cached cffi-1.17.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (1.5 kB)\n","Requirement already satisfied: pycparser in /usr/local/lib/python3.10/site-packages (from cffi==1.17.0) (2.21)\n","Using cached cffi-1.17.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (445 kB)\n","Installing collected packages: cffi\n","Successfully installed cffi-1.17.0\n"]}],"source":["!pip uninstall -y cffi\n","!pip uninstall -y _cffi_backend\n","!pip install cffi==1.17.0\n","\n","\n"]},{"cell_type":"code","execution_count":3,"metadata":{"id":"cYPamJE4kTOH","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1728050385990,"user_tz":-300,"elapsed":853,"user":{"displayName":"Ghaffar Elahi","userId":"03211535299359125772"}},"outputId":"35e52d40-e3ea-4536-f731-7a3fcd6d11e7"},"outputs":[{"output_type":"stream","name":"stdout","text":["1.17.1\n","1.17.0\n"]}],"source":["import cffi\n","import _cffi_backend\n","print(cffi.__version__)\n","print(_cffi_backend.__version__)"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"wEW3cWAAcd_4","executionInfo":{"status":"ok","timestamp":1728050390891,"user_tz":-300,"elapsed":4911,"user":{"displayName":"Ghaffar Elahi","userId":"03211535299359125772"}}},"outputs":[],"source":["import vectorbt as vbt\n","import talib as ta\n","import requests\n","import json\n","import math\n","import pandas_datareader as web\n","import numpy as np\n","import pandas as pd\n","import time\n","import datetime\n","\n","\n"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"QWjnjzu1cjhO","executionInfo":{"status":"ok","timestamp":1728050390892,"user_tz":-300,"elapsed":5,"user":{"displayName":"Ghaffar Elahi","userId":"03211535299359125772"}}},"outputs":[],"source":["class GetBinanceData:\n","    @staticmethod\n","    def get_data(symbol, interval, startDate=datetime.datetime(2020, 1, 1), endDate=datetime.datetime.now()):\n","        dataList = []\n","        current_date = datetime.datetime.now()\n","        start_date = startDate\n","\n","        delta_units = GetBinanceData.convert_to_minutes(interval)\n","        print(delta_units)\n","        delta = datetime.timedelta(minutes=delta_units)\n","\n","        while start_date < current_date:\n","            end_date = start_date + delta\n","            if end_date > current_date:\n","                end_date = current_date\n","            # Convert datetime objects to milliseconds\n","            start_ms = int(start_date.timestamp() * 1000)\n","            end_ms = int(end_date.timestamp() * 1000)\n","\n","            start_str = start_date.strftime('%Y-%m-%d %H:%M:%S')\n","            end_str = end_date.strftime('%Y-%m-%d %H:%M:%S')\n","\n","            # print(f\"Fetching data from {start_str} to {end_str}\")\n","            data = GetBinanceData.get_historical_data(symbol, interval, start_ms, end_ms)\n","            if data:\n","                dataList.extend(data)\n","            start_date = end_date\n","            time.sleep(1)\n","\n","        return dataList\n","\n","    @staticmethod\n","    def get_historical_data(symbol, interval, start_time, end_time):\n","        url = f\"https://api.binance.us/api/v3/klines\"\n","        params = {\n","            'symbol': symbol.upper(),\n","            'interval': interval,\n","            'startTime': start_time,\n","            'endTime': end_time,\n","            'limit': 1000\n","        }\n","        # print(params)\n","        response = requests.get(url, params=params)\n","        if response.status_code == 200:\n","            data = response.json()\n","            return data\n","        else:\n","\n","            print(f\"Failed to fetch data. Status code: {response.json()}\")\n","            return None\n","\n","    @staticmethod\n","    def convert_to_minutes(time_str):\n","        time_mapping = {\n","            'm': 1,\n","            'h': 60,\n","            'd': 1440,\n","            'w': 10080,\n","            'M': 43200\n","        }\n","\n","        num = int(time_str[:-1])\n","        unit = time_str[-1]\n","\n","        return (num * time_mapping[unit])*1000\n","\n","    def data_to_dataframe(data):\n","      # Define the column names based on Binance API response\n","      columns = [\n","          \"timestamp\", \"open\", \"high\", \"low\", \"close\", \"volume\",\n","          \"Close Time\", \"Quote Asset Volume\", \"Number of Trades\",\n","          \"Taker Buy Base Asset Volume\", \"Taker Buy Quote Asset Volume\", \"Ignore\"\n","      ]\n","      # Convert the data to a pandas DataFrame\n","      df = pd.DataFrame(data, columns=columns)\n","      # # Convert timestamp columns to datetime\n","      # df[\"timestamp\"] = pd.to_datetime(df['timestamp'])\n","      # df[\"Close Time\"] = pd.to_datetime(df[\"Close Time\"], unit='ms')\n","      # # Convert numeric columns to float\n","      # numeric_columns = [\"open\", \"high\", \"low\", \"close\", \"volume\", \"Quote Asset Volume\",\n","      #                   \"Taker Buy Base Asset Volume\", \"Taker Buy Quote Asset Volume\"]\n","      # df[numeric_columns] = df[numeric_columns].astype(float)\n","      return df\n","\n","    @staticmethod\n","    def get_data_dataFrame(symbol, interval, startDate=datetime.datetime(2020, 1, 1), endDate=datetime.datetime.now()):\n","        data = GetBinanceData.get_data(symbol, interval, startDate, endDate)\n","        return GetBinanceData.data_to_dataframe(data)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_EsCz3hHeI15"},"outputs":[],"source":["def merge_timeframes(higher_df, lower_df):\n","    merged_df = pd.merge_asof(lower_df.sort_values('timestamp'),\n","                               higher_df.sort_values('timestamp'),\n","                               on='timestamp',\n","                               direction='backward',\n","                               suffixes=('_lower', '_higher'))\n","    return merged_df"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":355722,"status":"ok","timestamp":1727930517248,"user":{"displayName":"Ghaffar Elahi","userId":"03211535299359125772"},"user_tz":-300},"id":"NsdOFIDfcnHe","outputId":"fb433289-89ae-4c1e-9b84-b8f1eb09afbc"},"outputs":[{"name":"stdout","output_type":"stream","text":["5000\n","60000\n"]}],"source":["symbol = \"ethusdt\"\n","\n","StartDate = datetime.datetime(2022, 1, 1)\n","EndDate = datetime.datetime.now()\n","\n","LowerTimeperiod = '5m'\n","downloadedDataLower = GetBinanceData.get_data(symbol,LowerTimeperiod, startDate=StartDate , endDate=EndDate)\n","\n","HigherTimeperiod = '1h'\n","downloadedDataHigher = GetBinanceData.get_data(symbol, HigherTimeperiod, startDate=StartDate , endDate=EndDate)\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CwvbijqGefIQ"},"outputs":[],"source":["lower_timeframe_df = GetBinanceData.data_to_dataframe(downloadedDataLower)\n","higher_timeframe_df = GetBinanceData.data_to_dataframe(downloadedDataHigher)\n","\n","lower_timeframe_df = lower_timeframe_df.apply(pd.to_numeric, errors='coerce')\n","higher_timeframe_df = higher_timeframe_df.apply(pd.to_numeric, errors='coerce')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"lnWiwVwmePzt"},"outputs":[],"source":["merged_df = merge_timeframes(higher_timeframe_df, lower_timeframe_df)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":478},"executionInfo":{"elapsed":11,"status":"ok","timestamp":1727930519496,"user":{"displayName":"Ghaffar Elahi","userId":"03211535299359125772"},"user_tz":-300},"id":"MTCrKcKpgvt3","outputId":"b9c65141-f298-4231-a47b-f955f017011d"},"outputs":[{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"merged_df"},"text/html":["\n","  <div id=\"df-f740cb37-361b-46a1-a541-f1974e396731\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>timestamp</th>\n","      <th>open_lower</th>\n","      <th>high_lower</th>\n","      <th>low_lower</th>\n","      <th>close_lower</th>\n","      <th>volume_lower</th>\n","      <th>Close Time_lower</th>\n","      <th>Quote Asset Volume_lower</th>\n","      <th>Number of Trades_lower</th>\n","      <th>Taker Buy Base Asset Volume_lower</th>\n","      <th>...</th>\n","      <th>high_higher</th>\n","      <th>low_higher</th>\n","      <th>close_higher</th>\n","      <th>volume_higher</th>\n","      <th>Close Time_higher</th>\n","      <th>Quote Asset Volume_higher</th>\n","      <th>Number of Trades_higher</th>\n","      <th>Taker Buy Base Asset Volume_higher</th>\n","      <th>Taker Buy Quote Asset Volume_higher</th>\n","      <th>Ignore_higher</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1640995200000</td>\n","      <td>3678.14</td>\n","      <td>3690.91</td>\n","      <td>3678.14</td>\n","      <td>3686.38</td>\n","      <td>12.19109</td>\n","      <td>1640995499999</td>\n","      <td>44970.963490</td>\n","      <td>47</td>\n","      <td>1.18442</td>\n","      <td>...</td>\n","      <td>3728.11</td>\n","      <td>3678.14</td>\n","      <td>3721.26</td>\n","      <td>148.99091</td>\n","      <td>1640998799999</td>\n","      <td>551385.371650</td>\n","      <td>445</td>\n","      <td>61.31505</td>\n","      <td>226759.834623</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1640995500000</td>\n","      <td>3687.29</td>\n","      <td>3704.75</td>\n","      <td>3686.38</td>\n","      <td>3696.22</td>\n","      <td>58.49543</td>\n","      <td>1640995799999</td>\n","      <td>215834.110673</td>\n","      <td>70</td>\n","      <td>34.57763</td>\n","      <td>...</td>\n","      <td>3728.11</td>\n","      <td>3678.14</td>\n","      <td>3721.26</td>\n","      <td>148.99091</td>\n","      <td>1640998799999</td>\n","      <td>551385.371650</td>\n","      <td>445</td>\n","      <td>61.31505</td>\n","      <td>226759.834623</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1640995800000</td>\n","      <td>3694.83</td>\n","      <td>3700.25</td>\n","      <td>3691.09</td>\n","      <td>3691.10</td>\n","      <td>15.45672</td>\n","      <td>1640996099999</td>\n","      <td>57117.432901</td>\n","      <td>31</td>\n","      <td>1.98570</td>\n","      <td>...</td>\n","      <td>3728.11</td>\n","      <td>3678.14</td>\n","      <td>3721.26</td>\n","      <td>148.99091</td>\n","      <td>1640998799999</td>\n","      <td>551385.371650</td>\n","      <td>445</td>\n","      <td>61.31505</td>\n","      <td>226759.834623</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1640996100000</td>\n","      <td>3691.10</td>\n","      <td>3692.45</td>\n","      <td>3684.99</td>\n","      <td>3687.71</td>\n","      <td>4.65828</td>\n","      <td>1640996399999</td>\n","      <td>17188.279833</td>\n","      <td>25</td>\n","      <td>1.18734</td>\n","      <td>...</td>\n","      <td>3728.11</td>\n","      <td>3678.14</td>\n","      <td>3721.26</td>\n","      <td>148.99091</td>\n","      <td>1640998799999</td>\n","      <td>551385.371650</td>\n","      <td>445</td>\n","      <td>61.31505</td>\n","      <td>226759.834623</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1640996400000</td>\n","      <td>3695.61</td>\n","      <td>3697.43</td>\n","      <td>3695.61</td>\n","      <td>3697.43</td>\n","      <td>1.78014</td>\n","      <td>1640996699999</td>\n","      <td>6581.450803</td>\n","      <td>9</td>\n","      <td>1.50968</td>\n","      <td>...</td>\n","      <td>3728.11</td>\n","      <td>3678.14</td>\n","      <td>3721.26</td>\n","      <td>148.99091</td>\n","      <td>1640998799999</td>\n","      <td>551385.371650</td>\n","      <td>445</td>\n","      <td>61.31505</td>\n","      <td>226759.834623</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>95</th>\n","      <td>1641023700000</td>\n","      <td>3722.76</td>\n","      <td>3722.76</td>\n","      <td>3710.71</td>\n","      <td>3716.01</td>\n","      <td>10.98113</td>\n","      <td>1641023999999</td>\n","      <td>40786.001048</td>\n","      <td>21</td>\n","      <td>0.33769</td>\n","      <td>...</td>\n","      <td>3723.90</td>\n","      <td>3702.88</td>\n","      <td>3716.01</td>\n","      <td>35.53908</td>\n","      <td>1641023999999</td>\n","      <td>131988.852730</td>\n","      <td>113</td>\n","      <td>5.87555</td>\n","      <td>21808.332107</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>96</th>\n","      <td>1641024000000</td>\n","      <td>3717.45</td>\n","      <td>3717.45</td>\n","      <td>3710.88</td>\n","      <td>3710.88</td>\n","      <td>0.44076</td>\n","      <td>1641024299999</td>\n","      <td>1636.152516</td>\n","      <td>2</td>\n","      <td>0.44076</td>\n","      <td>...</td>\n","      <td>3732.66</td>\n","      <td>3710.51</td>\n","      <td>3723.63</td>\n","      <td>8.51995</td>\n","      <td>1641027599999</td>\n","      <td>31742.835769</td>\n","      <td>58</td>\n","      <td>3.86042</td>\n","      <td>14378.813025</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>97</th>\n","      <td>1641024300000</td>\n","      <td>3711.99</td>\n","      <td>3711.99</td>\n","      <td>3710.51</td>\n","      <td>3710.51</td>\n","      <td>0.27418</td>\n","      <td>1641024599999</td>\n","      <td>1017.731009</td>\n","      <td>3</td>\n","      <td>0.00000</td>\n","      <td>...</td>\n","      <td>3732.66</td>\n","      <td>3710.51</td>\n","      <td>3723.63</td>\n","      <td>8.51995</td>\n","      <td>1641027599999</td>\n","      <td>31742.835769</td>\n","      <td>58</td>\n","      <td>3.86042</td>\n","      <td>14378.813025</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>98</th>\n","      <td>1641024600000</td>\n","      <td>3710.51</td>\n","      <td>3710.51</td>\n","      <td>3710.51</td>\n","      <td>3710.51</td>\n","      <td>0.00000</td>\n","      <td>1641024899999</td>\n","      <td>0.000000</td>\n","      <td>0</td>\n","      <td>0.00000</td>\n","      <td>...</td>\n","      <td>3732.66</td>\n","      <td>3710.51</td>\n","      <td>3723.63</td>\n","      <td>8.51995</td>\n","      <td>1641027599999</td>\n","      <td>31742.835769</td>\n","      <td>58</td>\n","      <td>3.86042</td>\n","      <td>14378.813025</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>99</th>\n","      <td>1641024900000</td>\n","      <td>3717.44</td>\n","      <td>3724.24</td>\n","      <td>3717.44</td>\n","      <td>3724.24</td>\n","      <td>0.78566</td>\n","      <td>1641025199999</td>\n","      <td>2920.715843</td>\n","      <td>4</td>\n","      <td>0.68496</td>\n","      <td>...</td>\n","      <td>3732.66</td>\n","      <td>3710.51</td>\n","      <td>3723.63</td>\n","      <td>8.51995</td>\n","      <td>1641027599999</td>\n","      <td>31742.835769</td>\n","      <td>58</td>\n","      <td>3.86042</td>\n","      <td>14378.813025</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>100 rows √ó 23 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f740cb37-361b-46a1-a541-f1974e396731')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-f740cb37-361b-46a1-a541-f1974e396731 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-f740cb37-361b-46a1-a541-f1974e396731');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-13ed0775-8dd1-4d70-9623-536cd06495d7\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-13ed0775-8dd1-4d70-9623-536cd06495d7')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-13ed0775-8dd1-4d70-9623-536cd06495d7 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"text/plain":["        timestamp  open_lower  high_lower  low_lower  close_lower  \\\n","0   1640995200000     3678.14     3690.91    3678.14      3686.38   \n","1   1640995500000     3687.29     3704.75    3686.38      3696.22   \n","2   1640995800000     3694.83     3700.25    3691.09      3691.10   \n","3   1640996100000     3691.10     3692.45    3684.99      3687.71   \n","4   1640996400000     3695.61     3697.43    3695.61      3697.43   \n","..            ...         ...         ...        ...          ...   \n","95  1641023700000     3722.76     3722.76    3710.71      3716.01   \n","96  1641024000000     3717.45     3717.45    3710.88      3710.88   \n","97  1641024300000     3711.99     3711.99    3710.51      3710.51   \n","98  1641024600000     3710.51     3710.51    3710.51      3710.51   \n","99  1641024900000     3717.44     3724.24    3717.44      3724.24   \n","\n","    volume_lower  Close Time_lower  Quote Asset Volume_lower  \\\n","0       12.19109     1640995499999              44970.963490   \n","1       58.49543     1640995799999             215834.110673   \n","2       15.45672     1640996099999              57117.432901   \n","3        4.65828     1640996399999              17188.279833   \n","4        1.78014     1640996699999               6581.450803   \n","..           ...               ...                       ...   \n","95      10.98113     1641023999999              40786.001048   \n","96       0.44076     1641024299999               1636.152516   \n","97       0.27418     1641024599999               1017.731009   \n","98       0.00000     1641024899999                  0.000000   \n","99       0.78566     1641025199999               2920.715843   \n","\n","    Number of Trades_lower  Taker Buy Base Asset Volume_lower  ...  \\\n","0                       47                            1.18442  ...   \n","1                       70                           34.57763  ...   \n","2                       31                            1.98570  ...   \n","3                       25                            1.18734  ...   \n","4                        9                            1.50968  ...   \n","..                     ...                                ...  ...   \n","95                      21                            0.33769  ...   \n","96                       2                            0.44076  ...   \n","97                       3                            0.00000  ...   \n","98                       0                            0.00000  ...   \n","99                       4                            0.68496  ...   \n","\n","    high_higher  low_higher  close_higher  volume_higher  Close Time_higher  \\\n","0       3728.11     3678.14       3721.26      148.99091      1640998799999   \n","1       3728.11     3678.14       3721.26      148.99091      1640998799999   \n","2       3728.11     3678.14       3721.26      148.99091      1640998799999   \n","3       3728.11     3678.14       3721.26      148.99091      1640998799999   \n","4       3728.11     3678.14       3721.26      148.99091      1640998799999   \n","..          ...         ...           ...            ...                ...   \n","95      3723.90     3702.88       3716.01       35.53908      1641023999999   \n","96      3732.66     3710.51       3723.63        8.51995      1641027599999   \n","97      3732.66     3710.51       3723.63        8.51995      1641027599999   \n","98      3732.66     3710.51       3723.63        8.51995      1641027599999   \n","99      3732.66     3710.51       3723.63        8.51995      1641027599999   \n","\n","    Quote Asset Volume_higher  Number of Trades_higher  \\\n","0               551385.371650                      445   \n","1               551385.371650                      445   \n","2               551385.371650                      445   \n","3               551385.371650                      445   \n","4               551385.371650                      445   \n","..                        ...                      ...   \n","95              131988.852730                      113   \n","96               31742.835769                       58   \n","97               31742.835769                       58   \n","98               31742.835769                       58   \n","99               31742.835769                       58   \n","\n","    Taker Buy Base Asset Volume_higher  Taker Buy Quote Asset Volume_higher  \\\n","0                             61.31505                        226759.834623   \n","1                             61.31505                        226759.834623   \n","2                             61.31505                        226759.834623   \n","3                             61.31505                        226759.834623   \n","4                             61.31505                        226759.834623   \n","..                                 ...                                  ...   \n","95                             5.87555                         21808.332107   \n","96                             3.86042                         14378.813025   \n","97                             3.86042                         14378.813025   \n","98                             3.86042                         14378.813025   \n","99                             3.86042                         14378.813025   \n","\n","    Ignore_higher  \n","0               0  \n","1               0  \n","2               0  \n","3               0  \n","4               0  \n","..            ...  \n","95              0  \n","96              0  \n","97              0  \n","98              0  \n","99              0  \n","\n","[100 rows x 23 columns]"]},"execution_count":26,"metadata":{},"output_type":"execute_result"}],"source":["merged_df.head(100)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"P15YV9QmeVNi"},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","import talib\n","\n","# Function to calculate the Bull Bear Power\n","def calculate_bbp(ha_high, ha_close, ha_low, bbp_length):\n","    bull_power = ha_high - talib.EMA(ha_close, timeperiod=bbp_length)\n","    bear_power = ha_low - talib.EMA(ha_close, timeperiod=bbp_length)\n","    return bull_power + bear_power\n","\n","# Function to calculate ADX\n","def calculate_adx(df, di_length, adx_smoothing_length):\n","    plus_di = talib.PLUS_DI(df['high_lower'], df['low_lower'], df['close_lower'], timeperiod=di_length)\n","    minus_di = talib.MINUS_DI(df['high_lower'], df['low_lower'], df['close_lower'], timeperiod=di_length)\n","    adx = talib.ADX(df['high_lower'], df['low_lower'], df['close_lower'], timeperiod=adx_smoothing_length)\n","    return plus_di, minus_di, adx\n","\n","# Merging higher and lower timeframes\n","def merge_timeframes(higher_df, lower_df):\n","    merged_df = pd.merge_asof(lower_df.sort_values('timestamp'),\n","                               higher_df.sort_values('timestamp'),\n","                               on='timestamp',\n","                               direction='backward',\n","                               suffixes=('_lower', '_higher'))\n","    return merged_df\n","\n","\n","\n","# Calculate Heikin-Ashi values (using a simplified version)\n","merged_df['ha_close'] = (merged_df['open_lower'] + merged_df['high_lower'] + merged_df['low_lower'] + merged_df['close_lower']) / 4\n","merged_df['ha_open'] = (merged_df['open_lower'].shift(1) + merged_df['close_lower'].shift(1)) / 2\n","merged_df['ha_high'] = merged_df[['high_lower', 'ha_open', 'ha_close']].max(axis=1)\n","merged_df['ha_low'] = merged_df[['low_lower', 'ha_open', 'ha_close']].min(axis=1)\n","\n","# Bull Bear Power calculation\n","bbp_length = 20\n","merged_df['bbp'] = calculate_bbp(merged_df['ha_high'], merged_df['ha_close'], merged_df['ha_low'], bbp_length)\n","\n","# ADX calculation\n","di_length = 14\n","adx_smoothing_length = 14\n","merged_df['plusDI'], merged_df['minusDI'], merged_df['adx'] = calculate_adx(merged_df, di_length, adx_smoothing_length)\n","\n","\n","\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PWmQ99yRfLNR"},"outputs":[],"source":["entries = (merged_df['bbp'] > 0) & (merged_df['adx'] > 20) & (merged_df['close_higher'] > merged_df['open_higher'])\n","exits = merged_df['bbp'] <= 0"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/","height":543,"output_embedded_package_id":"18i5AT6DfDq3mGOPGPW38dO2XssTn731g"},"id":"XT0gCOI9cK43","outputId":"5ca26bed-d351-4954-9e3e-6ed567d9ff33"},"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}],"source":["pf = vbt.Portfolio.from_signals(\n","    close=merged_df['close_lower'],\n","    entries=entries,\n","    exits = exits,\n","    tp_stop=0.05,\n","    init_cash=100,\n","    freq=LowerTimeperiod,\n","    sl_stop=0.02,\n","    sl_trail=True,\n","\n",")\n","\n","# Performance metrics\n","print(pf.stats())\n","\n","# Plot the results\n","pf.plot().show()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":298},"executionInfo":{"elapsed":5391,"status":"ok","timestamp":1727928847865,"user":{"displayName":"Ghaffar Elahi","userId":"03211535299359125772"},"user_tz":-300},"id":"yIIhqmu3la0U","outputId":"aa9afb2e-cd5c-424a-c3e0-124c60b1fc5e"},"outputs":[{"name":"stdout","output_type":"stream","text":["Found existing installation: cffi 1.17.0\n","Uninstalling cffi-1.17.0:\n","  Successfully uninstalled cffi-1.17.0\n","Collecting cffi\n","  Using cached cffi-1.17.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (1.5 kB)\n","Requirement already satisfied: pycparser in /usr/local/lib/python3.10/site-packages (from cffi) (2.21)\n","Using cached cffi-1.17.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (446 kB)\n","Installing collected packages: cffi\n","Successfully installed cffi-1.17.1\n"]},{"data":{"application/vnd.colab-display-data+json":{"id":"e5cb1b51d9a0441eb3ef5fe57d73745a","pip_warning":{"packages":["_cffi_backend","cffi"]}}},"metadata":{},"output_type":"display_data"},{"name":"stdout","output_type":"stream","text":["1.17.1\n"]}],"source":["\n","!pip uninstall -y cffi\n","\n","!pip install cffi\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":422,"status":"ok","timestamp":1727928866759,"user":{"displayName":"Ghaffar Elahi","userId":"03211535299359125772"},"user_tz":-300},"id":"x2_fbbRBlfDJ","outputId":"1352ca09-b2be-4116-d249-e08ea10bbdfc"},"outputs":[{"name":"stdout","output_type":"stream","text":["1.17.1\n"]}],"source":["import cffi\n","print(cffi.__version__)"]}],"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyMRzmlbZYrlrtKNQXzSn7g9"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}